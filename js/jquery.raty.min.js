(function(e){e.fn.raty=function(l){options=e.extend({},e.fn.raty.defaults,l);if(this.attr("id")===undefined){c("Invalid selector!");return;}$this=e(this);if(options.number>20){options.number=20;}if(options.path.substring(options.path.length-1,options.path.length)!="/"){options.path+="/";}var q=$this.attr("id");var u=options.path;var r=options.showHalf;var n=options.starHalf;var h=options.starOff;var o=options.starOn;var s=options.onClick;var g=0;if(!isNaN(options.start)&&options.start>0){g=(options.start>options.number)?options.number:options.start;}var m="";for(var p=1;p<=options.number;p++){m=(options.number<=options.hintList.length&&options.hintList[p-1]!==null)?options.hintList[p-1]:p;starFile=(g>=p)?o:h;$this.append('<img id="'+q+"-"+p+'" src="'+u+starFile+'" alt="'+p+'" title="'+m+'" class="'+q+'"/>').append((p<options.number)?"&nbsp;":"");}$this.css("width",options.number*20).append('<input id="'+q+'-score" type="hidden" name="'+options.scoreName+'"/>');e("#"+q+"-score").val(g);if(r){var k=e("input#"+q+"-score").val();var j=Math.ceil(k);var t=(j-k).toFixed(1);if(t>=0.3&&t<=0.7){j=j-0.5;e("img#"+q+"-"+Math.ceil(j)).attr("src",u+n);}else{if(t>=0.8){j--;}else{e("img#"+q+"-"+j).attr("src",u+o);}}}if(!options.readOnly){e("img."+q).live("mouseenter",function(){var v=e("img."+q).length;for(var w=1;w<=v;w++){if(w<=this.alt){e("img#"+q+"-"+w).attr("src",u+o);}else{e("img#"+q+"-"+w).attr("src",u+h);}}});e("img."+q).live("click",function(){e("input#"+q+"-score").val(this.alt);if(s){s(this.alt);}});$this.live("mouseleave",function(){var A=e(this).attr("id");var w=e("img."+A).length;var z=e("input#"+A+"-score").val();for(var x=1;x<=w;x++){if(x<=z){e("img#"+A+"-"+x).attr("src",u+o);}else{e("img#"+A+"-"+x).attr("src",u+h);}}if(r){var z=e("input#"+A+"-score").val();var v=Math.ceil(z);var y=(v-z).toFixed(1);if(y>=0.3&&y<=0.7){v=v-0.5;e("img#"+A+"-"+Math.ceil(v)).attr("src",u+n);}else{if(y>=0.8){v--;}else{e("img#"+A+"-"+v).attr("src",u+o);}}}}).css("cursor","pointer");}else{$this.css("cursor","default");}return $this;};e.fn.raty.defaults={hintList:["bad","poor","regular","good","gorgeous"],number:5,path:"img/",readOnly:false,scoreName:"score",showHalf:false,starHalf:"star-half.png",start:0,starOff:"star-off.png",starOn:"star-on.png"};e.fn.raty.readOnly=function(g){if(g){e("img."+$this.attr("id")).die();$this.css("cursor","default").die();}else{d();f();b();$this.css("cursor","pointer");}return e.fn.raty;};e.fn.raty.start=function(g){a(g);return e.fn.raty;};e.fn.raty.click=function(h){var g=(h>=options.number)?options.number:h;a(g);if(options.onClick){options.onClick(g);}else{c('You should add the "onClick: function() {}" option.');}return e.fn.raty;};function d(){var g=$this.attr("id");e("img."+g).live("mouseenter",function(){var h=e("img."+g).length;for(var j=1;j<=h;j++){if(j<=this.alt){e("img#"+g+"-"+j).attr("src",options.path+options.starOn);}else{e("img#"+g+"-"+j).attr("src",options.path+options.starOff);}}});}function f(){$this.live("mouseleave",function(){var k=e(this).attr("id");var g=e("img."+k).length;var j=e("input#"+k+"-score").val();for(var h=1;h<=g;h++){if(h<=j){e("img#"+k+"-"+h).attr("src",options.path+options.starOn);}else{e("img#"+k+"-"+h).attr("src",options.path+options.starOff);}}});}function b(){var g=$this.attr("id");e("img."+g).live("click",function(){e("input#"+g+"-score").val(this.alt);});}function a(k){var j=$this.attr("id");var g=e("img."+j).length;e("input#"+j+"-score").val(k);for(var h=1;h<=g;h++){if(h<=k){e("img#"+j+"-"+h).attr("src",options.path+options.starOn);}else{e("img#"+j+"-"+h).attr("src",options.path+options.starOff);}}}function c(g){if(window.console&&window.console.log){window.console.log(g);}}})(jQuery);